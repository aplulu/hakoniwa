apiVersion: v1
kind: Pod
metadata:
  name: webtop
  labels:
    app.kubernetes.io/name: hakoniwa-webtop
  annotations:
    hakoniwa.aplulu.me/display-name: "Webtop"
    hakoniwa.aplulu.me/description: "Full-featured Linux desktop environment."
    hakoniwa.aplulu.me/image-url: "/_hakoniwa/img/webtop.avif"
    hakoniwa.aplulu.me/port: "3000"
spec:
  containers:
    - name: desktop
      image: lscr.io/linuxserver/webtop:latest
      imagePullPolicy: IfNotPresent
      env:
        - name: PUID
          value: "1000"
        - name: PGID
          value: "1000"
        - name: DISABLE_SUDO
          value: "true"
      ports:
        - containerPort: 3000
          name: http
      livenessProbe:
        httpGet:
          path: /
          port: http
        initialDelaySeconds: 5
        periodSeconds: 10
      readinessProbe:
        httpGet:
          path: /
          port: http
        initialDelaySeconds: 5
        periodSeconds: 10
  restartPolicy: Never
---
apiVersion: v1
kind: Pod
metadata:
  name: code-server
  labels:
    app.kubernetes.io/name: code-server
  annotations:
    hakoniwa.aplulu.me/display-name: "Code-Server"
    hakoniwa.aplulu.me/description: "VS Code environment running in your browser."
    hakoniwa.aplulu.me/image-url: "/_hakoniwa/img/code-server.avif"
    hakoniwa.aplulu.me/port: "8080"
spec:
  containers:
    - name: code-server
      image: codercom/code-server:latest
      imagePullPolicy: IfNotPresent
      ports:
        - containerPort: 8080
          name: http
      livenessProbe:
        httpGet:
          path: /healthz
          port: http
        initialDelaySeconds: 5
        periodSeconds: 10
      readinessProbe:
        httpGet:
          path: /healthz
          port: http
        initialDelaySeconds: 5
        periodSeconds: 10
      volumeMounts:
        - name: workspace
          mountPath: /home/coder/project
      args:
        - "--auth=none"
        - "--bind-addr=0.0.0.0:8080"
  volumes:
    - name: workspace
      emptyDir: {}
---
apiVersion: v1
kind: Pod
metadata:
  name: jupyter-notebook
  labels:
    app.kubernetes.io/name: jupyter-notebook
  annotations:
    hakoniwa.aplulu.me/display-name: "Jupyter Notebook"
    hakoniwa.aplulu.me/description: "Interactive environment for data analysis and machine learning."
    hakoniwa.aplulu.me/image-url: "/_hakoniwa/img/jupyter-notebook.avif"
    hakoniwa.aplulu.me/port: "8888"
spec:
  containers:
    - name: jupyter
      image: jupyter/base-notebook:latest
      imagePullPolicy: IfNotPresent
      ports:
        - containerPort: 8888
          name: http
      livenessProbe:
        httpGet:
          path: /
          port: http
        initialDelaySeconds: 5
        periodSeconds: 10
      readinessProbe:
        httpGet:
          path: /
          port: http
        initialDelaySeconds: 5
        periodSeconds: 10
      args:
        - start-notebook.sh
        - --NotebookApp.ip=0.0.0.0
        - --NotebookApp.port=8888
        - --NotebookApp.token=''
      #      resources:
      #        requests:
      #          cpu: "250m"
      #          memory: "512Mi"
      #        limits:
      #          cpu: "1"
      #          memory: "2Gi"
      volumeMounts:
        - name: work
          mountPath: /home/jovyan/work
  volumes:
    - name: work
      emptyDir: {}
